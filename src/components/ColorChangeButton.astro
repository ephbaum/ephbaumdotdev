---
// Color change button component
---

<button
    id="color-change-btn"
    class="hover:text-green hover:underline transition-all duration-150 ease-in-out"
    title="Change theme colors"
    aria-label="Randomize theme colors"
    data-brutal-hover
>
    <div class="i-uil-palette w-6 h-6"></div>
</button>

<script>
    function changeColors() {
        // Track color palette interaction with analytics
        if (typeof window !== "undefined") {
            // Track with Vercel Analytics
            if (window.va) {
                window.va("event", "color_palette_click");
            }

            // Track with Umami Analytics
            if ((window as any).umami) {
                try {
                    // Try newer API first (umami.track)
                    if (typeof (window as any).umami.track === 'function') {
                        (window as any).umami.track("color_palette_click", {
                            action: "change_colors",
                            component: "color_palette_button",
                        });
                    }
                    // Fallback to older API (umami as function)
                    else if (typeof (window as any).umami === 'function') {
                        (window as any).umami("color_palette_click", {
                            action: "change_colors",
                            component: "color_palette_button",
                        });
                    }
                } catch (error) {
                    console.warn('Umami tracking failed:', error);
                }
            }
        }

        // Dispatch a custom event to trigger color changes across the site
        window.dispatchEvent(new CustomEvent("changeColors"));
    }

    document.addEventListener("DOMContentLoaded", () => {
        const colorChangeBtn = document.getElementById("color-change-btn");
        if (colorChangeBtn) {
            colorChangeBtn.addEventListener("click", changeColors);
        }
    });

    // Also listen for Astro page loads
    document.addEventListener("astro:page-load", () => {
        const colorChangeBtn = document.getElementById("color-change-btn");
        if (colorChangeBtn) {
            colorChangeBtn.addEventListener("click", changeColors);
        }
    });
</script>
