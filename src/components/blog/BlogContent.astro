---
import { Button } from "@eliancodes/brutal-ui";

interface Props {
  authorColor?: string;
  content: any;
  publishedColor?: string;
}

const { authorColor, content, publishedColor } = Astro.props;
---

<style>
  .author-color {
    color: var(--authorColor, #ff0000);
    opacity: 0.5;
  }

  .author-color:hover {
    opacity: 1;
  }

  .published-color {
    color: var(--publishedColor, #0000ff);
    opacity: 0.5;
  }

  .published-color:hover {
    opacity: 1;
  }
</style>

<article class="prose-slate w-sm md:w-prose md:prose poppins">
  <Button href="/blog/" data-brutal-button data-brutal-hover>
    &larr; Back to blog
  </Button>
  <h1 class="mt-8 text-2xl md:text-4xl">{content.title}</h1>
  <p class="published-color text-opacity-50 text-sm md:text-base">
    Published on {content.pubDate} by {content.author}
  </p>
  <slot />
  <p class="author-color">Written by {content.author}</p>
  <Button href="/blog/" data-brutal-button data-brutal-hover>
    &larr; Back to blog
  </Button>
</article>

<script src="/global-color-system.js" is:inline></script>
<script>
  // Apply random colors for author and published text
  function applyRandomColors() {
    const article = document.querySelector("article");
    if (article && window.BrutalColorSystem) {
      const colors = window.BrutalColorSystem.colors;
      const colorMap = window.BrutalColorSystem.colorMap;

      // Generate random colors
      const authorColor = colors[Math.floor(Math.random() * colors.length)];
      const publishedColor = colors[Math.floor(Math.random() * colors.length)];

      // Set CSS custom properties
      article.style.setProperty("--authorColor", colorMap[authorColor]);
      article.style.setProperty("--publishedColor", colorMap[publishedColor]);
    }
  }

  // Apply on initial load
  document.addEventListener("DOMContentLoaded", applyRandomColors);

  // Also apply on Astro page loads (for SPA navigation)
  document.addEventListener("astro:page-load", applyRandomColors);

  // Listen for color change events from the palette button
  window.addEventListener("changeColors", applyRandomColors);
</script>
